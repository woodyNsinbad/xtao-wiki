# CPU数量含义

## 指定资源中CPU的含义

**任务投递过程中指定的并不是物理cpu核心，而是总共的逻辑cpu核心**。

比如集群中某个节点的cpu配置是1个物理cpu4个物理核心并且开启了超线程，那么最终在集群中这个节点就一共有8个cpu。

---

申请的CPU和任务的线程峰值（任务程序的完整生命周期中线程的最大值）相等即可，这取决于任务的多线程是如何工作的。

+ 如果N个线程需要并行执行，则应该申请 `N CPU`；
+ 如果N个线程有先后，某些线程的任务结束了，才会启动另一部分线程，则不需要申请 N CPU。而是申请小于N 个CPU 

具体的CPU数量，可以通过:

1. 通过程序预估。
2. 通过运行任务的表现来调节，我们提供了自动调节任务资源的功能，在集群资源较为宽裕的情况下，可以由集群根据任务的运行情况帮助你自动调节任务的实时资源，最后的调节结果就是最接近这个任务的理想资源的值

用户投递的脚本任务最终只能转化成一个进程在某个满足要求的节点执行。可以通过执行qhost 可以查看集群所有节点的资源情况，如果没有单个节点的可用cpu满足100cpu，则这个任务就需要等待，直到满足。

> 例如，截至2023年1月1日，系统内胖节点的最大CPU资源数为160，而其中已经被使用的有100。其他节点的CPU最大值小于100。此时因为集群内没有节点的可用CPU满足任务需求，任务会进入排队状态直到CPU满足任务需求。
{.is-info}


**事实上CPU 数量也可以是浮点型变量。** 例如 cpu=1.5 

此时 CPU的含义为：任务进程占用所在节点的CPU “时间占比”为1.5。

因此当任务申请CPU较少时，大多数情况下依然可以执行（运行较慢）。而不会像内存不足一样被系统停止。

---